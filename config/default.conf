# Serveur par d√©faut sur 127.0.0.1:8080 (pas de server_name)
server {
    listen 127.0.0.1:8080;
    root www;
    error_page 404 /errors/404.html;
    error_page 500 /errors/500.html;
    client_max_body_size 1M;

    session_enable off;
    session_name SESSIONID;
    session_timeout 3600;

    location / {
        index index.html;
        autoindex on;
        allowed_methods GET POST;
        cookies_enabled on;
    }

    location /upload {
        allowed_methods POST;
        upload_path /tmp/uploads;
        cookies_enabled off;
    }

    location /redir {
        return 301 http://example.com;
        cookies_enabled off;
    }

    location /cgi {
        cgi_extension .py;
        root www/cgi-bin;
        allowed_methods GET POST;
        cookies_enabled on;
    }

    location /dir {
        root www;
        autoindex off;
        index home.html;
        allowed_methods GET;
        cookies_enabled on;
    }
}

# Serveur secondaire sur 127.0.0.1:8080 avec un server_name
server {
    listen 127.0.0.1:8080;
    server_name test.local www.test.local;
    root www;
    client_max_body_size 2M;
    error_page 404 /errors/404.html;

    session_enable on;
    session_name USERSESSION;
    session_timeout 1800;

    location / {
        index index.html;
        allowed_methods GET;
        cookies_enabled on;
    }

    location /form {
        allowed_methods POST GET;
        upload_path /tmp/form_uploads;
        cookies_enabled on;
    }

    location /php {
        cgi_extension .php;
        root www;
        allowed_methods GET POST;
        cookies_enabled on;
    }

    location /static {
        root www;
        autoindex on;
        cookies_enabled off;
    }
}

# Serveur sur port alternatif
server {
    listen 127.0.0.1:8081;
    server_name alt.test;
    root www;
    client_max_body_size 512K;
    error_page 500 /errors/500.html;

    session off;

    location / {
        index main.html;
        allowed_methods GET;
        cookies_enabled off;
    }

    location /cgi-bin {
        cgi_extension .pl;
        root www;
        allowed_methods POST;
        cookies_enabled on;
    }
}
